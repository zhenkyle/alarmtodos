!function e(t,i,n){function o(r,l){if(!i[r]){if(!t[r]){var a="function"==typeof require&&require;if(!l&&a)return a(r,!0);if(s)return s(r,!0);var u=new Error("Cannot find module '"+r+"'");throw u.code="MODULE_NOT_FOUND",u}var c=i[r]={exports:{}};t[r][0].call(c.exports,function(e){var i=t[r][1][e];return o(i?i:e)},c,c.exports,e,t,i,n)}return i[r].exports}for(var s="function"==typeof require&&require,r=0;r<n.length;r++)o(n[r]);return o}({1:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(i,"__esModule",{value:!0});var o=e("../models/todo"),s=n(o);i["default"]=Backbone.Collection.extend({model:s["default"],localStorage:new Backbone.LocalStorage("todos-backbone"),done:function(){return this.filter(function(e){return e.get("done")})},remaining:function(){return this.without.apply(this,this.done())},nextOrder:function(){return this.length?this.last().get("order")+1:1},comparator:function(e){return e.get("order")}})},{"../models/todo":4}],2:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var o=e("./collections/todolist"),s=n(o),r=e("./views/appview"),l=n(r),a=new s["default"];new l["default"]({collection:a})},{"./collections/todolist":1,"./views/appview":6}],3:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=Backbone.Model.extend({defaults:function(){return{beep_every_second:!0,id:1}},localStorage:new Backbone.LocalStorage("todos-backbone-settings")})},{}],4:[function(e,t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=Backbone.Model.extend({defaults:function(){return{title:"empty todo...",order:void 0==this.collection?0:this.collection.nextOrder(),done:!1,elapse:1500}},initialize:function(){this.get("title")||this.set({title:this.defaults().title})},toggle:function(){this.fetch(),this.save({done:!this.get("done")})}})},{}],5:[function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){return e<10&&(e="0"+e),e}Object.defineProperty(i,"__esModule",{value:!0}),i["default"]=function(e){var t=(0,r["default"])({days:!1})(e);return o(t.hours)+":"+o(t.minutes)+":"+o(t.seconds)};var s=e("parse-seconds"),r=n(s)},{"parse-seconds":9}],6:[function(require,module,exports){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var _todoview=require("./todoview"),_todoview2=_interopRequireDefault(_todoview),_settings=require("../models/settings"),_settings2=_interopRequireDefault(_settings),_beepjs=require("beepjs"),_beepjs2=_interopRequireDefault(_beepjs);exports["default"]=Backbone.View.extend({el:$("#todoapp"),statsTemplate:_.template($("#stats-template").html()),events:{"keypress #new-todo":"createOnEnter","click #clear-completed":"clearCompleted","click #toggle-all":"toggleAllComplete","click #start-alarm":"startAlarm","click #stop-alarm":"stopAlarm","click #beep-every-second":"toggleSettings"},initialize:function(){this.input=this.$("#new-todo"),this.allCheckbox=this.$("#toggle-all")[0],this.beepCheckbox=this.$("#beep-every-second")[0],this.listenTo(this.collection,"add",this.addOne),this.listenTo(this.collection,"reset",this.addAll),this.listenTo(this.collection,"all",this.render),this.listenTo(this.settings,"all",this.render),this.footer=this.$("footer"),this.main=$("#main"),this.timeoutID=null,this.first_remaining=null;var e=1,t="square";this.beep=new _beepjs2["default"](e,t),this.settings=new _settings2["default"],this.settings.fetch(),this.collection.fetch()},render:function(){var e=this.collection.done().length,t=this.collection.remaining().length,i=this.timeoutID;this.collection.length?(this.main.show(),this.footer.show(),this.footer.html(this.statsTemplate({done:e,remaining:t,timeoutID:i}))):(this.main.hide(),this.footer.hide()),this.allCheckbox.checked=!t,this.beepCheckbox.checked=this.settings.get("beep_every_second")},addOne:function(e){var t=new _todoview2["default"]({model:e});this.$("#todo-list").append(t.render().el)},addAll:function(){this.collection.each(this.addOne,this)},createOnEnter:function createOnEnter(e){if(13==e.keyCode&&this.input.val()){var splits=this.input.val().split("/",2);splits[1]=splits[1]||25,splits[1]=eval(60*splits[1].valueOf()),this.collection.create({title:splits[0],elapse:splits[1]}),this.input.val("")}},clearCompleted:function(){return clearTimeout(this.timeoutID),this.first_remaining=null,this.timeoutID=null,_.invoke(this.collection.done(),"destroy"),!1},toggleAllComplete:function(){clearTimeout(this.timeoutID),this.first_remaining=null,this.timeoutID=null;var e=this.allCheckbox.checked;this.collection.each(function(t){t.save({done:e})})},toggleSettings:function(){var e=this.beepCheckbox.checked;this.settings.save({beep_every_second:e})},startAlarm:function(){if(!this.timeoutID){this.first_remaining=_.first(this.collection.remaining());var e=_.bind(this.startAlarm,this);return this.timeoutID=_.delay(e,1e3),void this.render()}var t=this.first_remaining.get("elapse");if(t<=1)this.first_remaining.fetch(),this.first_remaining.set({done:!0}),this.first_remaining=null,this.timeoutID=null,this.render(),this.beep.beep([[1e3,100],[0,100],[1e3,100],[0,100],[1e3,100],[0,300],[1e3,100],[0,100],[1e3,100],[0,100],[1e3,100],[0,300],[1e3,100],[0,100],[1e3,100],[0,100],[1e3,100],[0,300],[1e3,100],[0,100],[1e3,100],[0,100],[1e3,100],[0,300],[1e3,100],[0,100],[1e3,100],[0,100],[1e3,100],[0,300],[1e3,100],[0,100],[1e3,100],[0,100],[1e3,100],[0,300]]);else{this.first_remaining.set({elapse:t-1});var e=_.bind(this.startAlarm,this);this.timeoutID=_.delay(e,1e3),1==this.settings.get("beep_every_second")&&this.beep.beep([[1e3,100]])}},stopAlarm:function(){clearTimeout(this.timeoutID),this.first_remaining=null,this.timeoutID=null,this.render()}})},{"../models/settings":3,"./todoview":7,beepjs:8}],7:[function(require,module,exports){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var _formated_seconds=require("app/utils/formated_seconds"),_formated_seconds2=_interopRequireDefault(_formated_seconds);exports["default"]=Backbone.View.extend({tagName:"li",template:_.template($("#item-template").html()),events:{"click .toggle":"toggleDone","dblclick .view":"edit","touchstart .view":"edit","click a.destroy":"clear","keypress .edit":"updateOnEnter","blur .edit":"close"},initialize:function(){this.listenTo(this.model,"change",this.render),this.listenTo(this.model,"destroy",this.remove)},render:function(){return this.$el.html(this.template(_.extend(this.model.toJSON(),{formated_seconds:(0,_formated_seconds2["default"])(this.model.get("elapse"))}))),this.$el.toggleClass("done",this.model.get("done")),this.input=this.$(".edit"),this},toggleDone:function(){this.model.toggle()},edit:function(){this.$el.addClass("editing"),this.input.focus()},close:function close(){var value=this.input.val();if(value){var splits=value.split("/",2);splits[1]=splits[1]||25,splits[1]=parseInt(60*eval(splits[1].valueOf())),this.model.save({title:splits[0],elapse:splits[1]}),this.$el.removeClass("editing")}else this.clear()},updateOnEnter:function(e){13==e.keyCode&&this.close()},clear:function(){this.model.destroy()}})},{"app/utils/formated_seconds":5}],8:[function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}i.__esModule=!0;var o=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?1:arguments[0],i=arguments.length<=1||void 0===arguments[1]?"square":arguments[1];n(this,e),this._volume=t,this._waveType=i}return e.prototype.init=function(){return"undefined"==typeof this._audioContext?(this._audioContext=this._getAudioContext(),Promise.resolve()):Promise.resolve()},e.prototype.beep=function(e){var t=this;return this.init().then(function(){return new Promise(function(i,n){var o=t._createGainNode(t._volume),s=t._createOscillatorNode(t._waveType);s.onended=function(){return i()};var r=t._audioContext.currentTime,l=e.shift(),a=l[0],u=l[1],c=r+t._msToS(u);s.frequency.value=a,e.forEach(function(e){var i=e[0],n=e[1];s.frequency.setValueAtTime(i,c),c+=t._msToS(n)}),s.connect(o),o.connect(t._audioContext.destination),s.start(r),s.stop(c)})})},e.prototype._createOscillatorNode=function(e){var t=this._audioContext.createOscillator();return t.start=t.noteOn||t.start,t.stop=t.noteOff||t.stop,t.type=e,t},e.prototype._createGainNode=function(e){var t=this._audioContext.createGain();return t.start=t.noteOn||t.start,t.stop=t.noteOff||t.stop,t.gain.value=e,t},e.prototype._getAudioContext=function(){return new(window.AudioContext||window.webkitAudioContext)},e.prototype._msToS=function(e){return e/1e3},e}();i["default"]=o},{}],9:[function(e,t,i){t.exports=function(e){function t(t){var i={years:0,weeks:0,days:0,hours:0,minutes:0};return e.years!==!1&&(i.years=~~(t/60/60/24/365),t-=60*i.years*60*24*365),e.weeks!==!1&&(i.weeks=~~(t/60/60/24/7),t-=60*i.weeks*60*24*7),e.days!==!1&&(i.days=~~(t/60/60/24),t-=60*i.days*60*24),e.hours!==!1&&(i.hours=~~(t/60/60),t-=60*i.hours*60),e.minutes!==!1&&(i.minutes=~~(t/60),t-=60*i.minutes),i.seconds=t,i}return void 0===e&&(e={}),isNaN(e)?t:t(e)}},{}]},{},[2]);